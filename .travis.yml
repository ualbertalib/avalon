---
git:
  submodules: false
bundler_args: --with mysql aws --without development debug
env:
  - FCREPO_URL=http://127.0.0.1:8986/rest SOLR_TEST_URL=http://127.0.0.1:8985/solr/hydra-test RAILS_ENV=test DATABASE_URL=mysql2://root:mysecretpassword@127.0.0.1:3306/
services:
  - mysql2
  - redis-server
before_install:
  - sudo rm -vf /etc/apt/sources.list.d/*riak*
  - sudo rm -vf /etc/apt/sources.list.d/*hhvm*
  - sudo apt-get update
  - sudo apt-get install mediainfo
  - sudo ln -s /usr/bin/lsof /usr/sbin/lsof
  - bundle config without development:production:staging:uat
before_script:
  - bundle exec rake db:create
  - bundle exec rake db:migrate
script:
  - bundle exec rake
language: ruby
jdk:
  - oraclejdk8
rvm:
  - 2.4
  - 2.5
dist: trusty
sudo: required
